
function asyncGeneratorStep(t, e, n, r, a, o, i) {
    try {
        var c = t[o](i),
            s = c.value
    } catch (t) {
        return void n(t)
    }
    c.done ? e(s) : Promise.resolve(s).then(r, a)
}

function _asyncToGenerator(t) {
    return function () {
        var e = this,
            n = arguments;
        return new Promise(function (r, a) {
            var o = t.apply(e, n);

            function i(t) {
                asyncGeneratorStep(o, r, a, i, c, "next", t)
            }

            function c(t) {
                asyncGeneratorStep(o, r, a, i, c, "throw", t)
            }
            i(void 0)
        })
    }
}
var total = [[92718, 5582] //彰化縣
            ,[30351, 1705] //南投縣
            ,[35940, 1778] // 雲林縣
            ,[66598, 3236] // 屏東縣
            ,[65818, 1115] // 基隆市
            ,[47282, 1806] // 新竹市
            ,[303254, 5531] // 臺北市
            ,[694065, 11443] // 新北市
            ,[253026, 11587] // 臺中市
            ,[149772, 7054] // 臺南市
            ,[334386, 8039] // 桃園市
            ,[45227, 1687] // 苗栗縣
            ,[68081, 2293] // 新竹縣
            ,[16198, 878] // 嘉義市
            ,[25119, 1367] // 嘉義縣
            ,[254747, 11048] // 高雄市
            ,[19892, 933] // 臺東縣
            ,[41804, 1223] // 花蓮縣
            ,[54146, 1420] // 宜蘭縣
        ]           
var TaiwanMap = new Vue({
    el: "#app",
    data: {
        h1: "請選擇一個縣市",
        h2: "",
        h3: ""
    },
    methods: {
        getTaiwanMap: function () {
            var t = _asyncToGenerator(regeneratorRuntime.mark(function t() {
                var e, n, r, a, o, i, c = this;
                return regeneratorRuntime.wrap(function (t) {
                    for (; ;) switch (t.prev = t.next) {
                        case 0:
                            return e = this.$refs.map.offsetWidth.toFixed(), n = this.$refs.map.offsetHeight.toFixed(), a = window.screen.width, r = a > 1366 ? 11e3 : a <= 1366 && a > 480 ? 9e3 : 6e3, t.next = 5, d3.geo.path().projection(d3.geo.mercator().center([121, 24]).scale(r).translate([e / 2, n / 2.5]));
                        case 5:
                            return o = t.sent, t.next = 8, d3.select("#svg").attr("width", e).attr("height", n).attr("viewBox", "0 0 ".concat(e, " ").concat(n));
                        case 8:
                            return i = t.sent, "dist/taiwan.geojson", t.next = 12, d3.json("dist/taiwan.geojson", function (t, e) {
                                if (t) throw t;
                                i.selectAll("path").data(e.features).enter().append("path").attr("d", o).attr({
                                    id: function (t) {
                                        return "city" + t.properties.COUNTYCODE
                                    }
                                }).on("click", function (t) {
                                    c.h1 = t.properties.COUNTYNAME, document.querySelector(".active") && document.querySelector(".active").classList.remove("active"), document.getElementById("city" + t.properties.COUNTYCODE).classList.add("active")
                                    c.h2 =  `確診數: ${total[t.properties.COUNTYCODE][0]}`
                                    c.h3 =  `新增數: +${total[t.properties.COUNTYCODE][1]}`
                                })
                            });
                        case 12:
                            return t.abrupt("return", i);
                        case 13:
                        case "end":
                            return t.stop()
                    }
                }, t, this)
            }));
            return function () {
                return t.apply(this, arguments)
            }
        }()
    },
    mounted: function () {
        this.getTaiwanMap()
    }
});